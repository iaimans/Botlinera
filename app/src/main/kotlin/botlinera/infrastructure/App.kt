/*
 * This Kotlin source file was generated by the Gradle 'init' task.
 */
package botlinera.infrastructure

import botlinera.application.usecases.NearGasStation
import botlinera.application.usecases.UpdateGasStations
import botlinera.domain.valueobject.Coordinates
import botlinera.infrastructure.adapters.GasStationsRetrieverFromSpanishGovernment
import botlinera.infrastructure.utils.URLWrapper
import botlinera.infrastucture.adapters.GastStationPersisterMongo

fun main() {
    println("Botlinera is now working!")
    val gasStationPersister = GastStationPersisterMongo(System.getenv("DATABASE_URL"))
    UpdateGasStations(
        GasStationsRetrieverFromSpanishGovernment(
            URLWrapper()
        ),
        gasStationPersister
    ).execute()
    val gasStations =
        NearGasStation(gasStationPersister).execute(Coordinates("28.0427319".toDouble(), "-16.7116703".toDouble()))
    gasStations.forEach { gasStation ->
        println(gasStation.name)
        println(gasStation.latitudeAsText() + "," + gasStation.longitudeAsText())
        println(gasStation.gas95AsText())
    }
}
